# .github/workflows/update-other-repo.yml
name: Update Other Repo on Tag in UAT

on:
  push:
    tags:
      - 'rc-*'  # e.g., rc-v1.0.0, rc-release, etc.
  workflow_dispatch: 

jobs:
  update-file:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout this repo
        uses: actions/checkout@v3

      - name: Clone target repo
        run: |
          git clone https://x-access-token:${{ secrets.TARGET_REPO_TOKEN }}@github.com/zhunan915/augocd.git
          cd augocd
          git checkout -b uat
          git pull -f origin uat
          cd frontend/posts
          sed -i 's#v1.0.0#v1.0.1#' frontend-posts.yaml
          git config --global user.email "zshuai@dons.usfca.edu"
          git config --global user.name "zhunan915"
          git add frontend-posts.yaml
          git commit -m "Update frontend-posts.yaml to v1.0.1"
          git push origin uat

